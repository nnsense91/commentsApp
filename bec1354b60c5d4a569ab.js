(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{322:function(e,t,n){},329:function(e,t,n){"use strict";var o=n(322);n.n(o).a},336:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{staticClass:"comments__item"},[n("div",{staticClass:"comment",class:{bad:this.comment.rating<=-10}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.isCommentBad,expression:"!isCommentBad"}],staticClass:"comment__avatar"}),n("div",{staticClass:"comment__content"},[n("div",{staticClass:"comment__header"},[n("div",{staticClass:"comment__info"},[n("h3",{staticClass:"comment__owner"},[e._v(e._s(e.comment.author))]),n("div",{staticClass:"comment__lifetime"},[n("span",[e._v(e._s(e.time))])]),n("commentRating",{attrs:{commentRating:e.comment.rating,commentId:e.comment.id}})],1),n("div",{staticClass:"comment__reply"},[e.isCommentBad?e._e():n("button",{staticClass:"comment__reply-btn",on:{click:e.clickReply}},[e._v("Ответить")]),e.isHaveSubtree?n("button",{staticClass:"comment__showtree-btn",on:{click:e.toggleSubtreeHandle}},[e._v(e._s(e.isSubcommentTreeShow?"-":"+"))]):e._e(),e.isCommentBad?n("button",{staticClass:"comment__reply-btn",on:{click:e.showCommentHandle}},[e._v("Показать комментарий")]):e._e()])]),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.isCommentBad,expression:"!isCommentBad"}],staticClass:"comment__text",domProps:{innerHTML:e._s(e.addMarkdown(e.comment.text))}})])]),e.isOpenAddForm?n("commentsAddNew",{attrs:{targetId:e.comment.id},on:{closeAddCommentForm:e.closeAddCommentForm}}):e._e(),n("ul",{staticClass:"subcomment__list"},e._l(e.comment.children,function(t){return e.isSubcommentTreeShow?n("commentsItem",{key:t.id,attrs:{comment:t,activeId:e.activeId},on:{clickReply:e.clickReplyHandle,closeAddCommentForm:e.closeAddCommentForm}}):e._e()}),1)],1)};function c(e,t,n,o,c,i,m){try{var s=e[i](m),r=s.value}catch(e){return void n(e)}s.done?t(r):Promise.resolve(r).then(o,c)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){var m=e.apply(t,n);function s(e){c(m,o,i,s,r,"next",e)}function r(e){c(m,o,i,s,r,"throw",e)}s(void 0)})}}o._withStripped=!0;var m={data:function(){return{time:"",isShowComment:!1,isSubcommentTreeShow:!1}},components:{commentRating:function(){return n.e(3).then(n.bind(null,338))},commentsItem:function(){return Promise.resolve().then(n.bind(null,336))},commentsAddNew:function(){return n.e(0).then(n.bind(null,335))}},props:{comment:Object,activeId:Number},methods:{lifeTimeHandle:function(e){try{var t=(new Date).getTime()-this.comment.creationTime;this.time=t<36e5?"".concat(Math.trunc(t/6e4)," мин назад"):t>36e5&&t<864e5?"".concat(Math.trunc(t/36e5)," часов назад"):"".concat(Math.trunc(t/864e5)," суток назад")}catch(e){console.log(e.message),alert("Ошибка! Не удалось посчитать дату написания комментария")}},showCommentHandle:function(){this.isShowComment=!0},clickReply:function(){this.isSubcommentTreeShow=!0,this.$emit("clickReply",this.comment.id)},clickReplyHandle:function(e){this.$emit("clickReply",e)},closeAddCommentForm:function(){this.$emit("closeAddCommentForm")},toggleSubtreeHandle:function(){try{this.isSubcommentTreeShow=!this.isSubcommentTreeShow,!1===this.isSubcommentTreeShow&&this.$emit("closeAddCommentForm")}catch(e){console.log(e.message),alert("Ошибка! Не удалось показать дерево комментариев.")}},addMarkdown:function(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/[\#]{6}(.+)/g,"<h6>$1</h6>")).replace(/[\#]{5}(.+)/g,"<h5>$1</h5>")).replace(/[\#]{4}(.+)/g,"<h4>$1</h4>")).replace(/[\#]{3}(.+)/g,"<h3>$1</h3>")).replace(/[\#]{2}(.+)/g,"<h2>$1</h2>")).replace(/[\#]{1}(.+)/g,"<h1>$1</h1>")).replace(/^\>(.+)/gm,"<blockquote>$1</blockquote>")).replace(/^\s*\n\*/gm,"<ul>\n*")).replace(/^(\*.+)\s*\n([^\*])/gm,"$1\n</ul>\n\n$2")).replace(/^\*(.+)/gm,"<li>$1</li>")).replace(/[\[]{1}([^\]]+)[\]]{1}[\(]{1}([^\)\"]+)(\"(.+)\")?[\)]{1}/g,'<a href="$2" title="$4">$1</a>')}},created:function(){this.addMarkdown(this.comment.text)},mounted:function(){var e=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.lifeTimeHandle(this.comment.creationTime);case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),alert("Ошибка! Не удалось отобразить дату написания комментария."),console.log(e.t0.message);case 9:case"end":return e.stop()}},e,this,[[0,5]])}));return function(){return e.apply(this,arguments)}}(),updated:function(){var e=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.lifeTimeHandle(this.comment.creationTime);case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),alert("Ошибка! Не удалось обновить дату написания комментария."),console.log(e.t0.message);case 9:case"end":return e.stop()}},e,this,[[0,5]])}));return function(){return e.apply(this,arguments)}}(),computed:{isHaveSubtree:function(){return 0!==this.comment.children.length},isOpenAddForm:function(){if(this.comment.id===this.activeId)return!0},isCommentBad:function(){return!(this.comment.rating>-10)&&!(this.comment.rating<=-10&&!0===this.isShowComment)}}},s=(n(329),n(92)),r=Object(s.a)(m,o,[],!1,null,"0e1a17b7",null);r.options.__file="src/components/commentsItem.vue";t.default=r.exports}}]);